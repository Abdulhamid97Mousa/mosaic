# Environment configuration for MOSAIC
# Copy this file to `.env` and adjust values for your local setup.

# ==============================================================================
# Qt Configuration
# ==============================================================================
# IMPORTANT: Must be "PyQt6" (with capitals) for qasync to work correctly
QT_API=PyQt6

# Force X11/xcb platform plugin (avoids wayland fallback warnings on WSLg)
# Options: xcb (X11), wayland, offscreen (headless), minimal (no display)
QT_QPA_PLATFORM=xcb

# Disable Qt plugin debugging
QT_DEBUG_PLUGINS=0

# Use software rendering for QQuickWidget (avoids QRhiGles2 errors on WSLg)
# Set these if you see "QRhiGles2: Failed to create temporary context" errors.
# QT_QUICK_BACKEND=software bypasses the RHI layer entirely (no OpenGL needed).
# Native Ubuntu users can comment out QT_QUICK_BACKEND and LIBGL_ALWAYS_SOFTWARE.
QT_QUICK_BACKEND=software
QSG_RHI_BACKEND=gl
LIBGL_ALWAYS_SOFTWARE=1

# Disable QML disk cache
QML_DISABLE_DISK_CACHE=1

# ==============================================================================
# Gymnasium Defaults
# ==============================================================================
# GYM_DEFAULT_ENV=FrozenLake-v1
GYM_CONTROL_MODE=human_only
GYM_LOG_LEVEL=DEBUG

# ==============================================================================
# Generic Environment Defaults (0 uses Gym defaults)
# ==============================================================================
# These apply to all environments unless overridden by specific settings below
DEFAULT_MAX_EPISODE_STEPS=0
DEFAULT_MAX_EPISODE_SECONDS=0
DEFAULT_RENDER_FPS=30

# ==============================================================================
# Classic Control Environments
# ==============================================================================
# CartPole
CART_POLE_MAX_EPISODE_STEPS=0
# Acrobot
ACROBOT_MAX_EPISODE_STEPS=0
# MountainCar
MOUNTAIN_CAR_MAX_EPISODE_STEPS=0
# Pendulum
PENDULUM_MAX_EPISODE_STEPS=0

# ==============================================================================
# Box2D Environments
# ==============================================================================
# CarRacing
CAR_RACING_MAX_EPISODE_STEPS=0
CAR_RACING_MAX_EPISODE_SECONDS=0
CAR_RACING_LAP_COMPLETE_PERCENT=0.95
# Bipedal Walker
BIPEDAL_MAX_EPISODE_STEPS=0
BIPEDAL_MAX_EPISODE_SECONDS=0
BIPEDAL_HARDCORE=false
# Lunar Lander
LUNAR_LANDER_MAX_EPISODE_STEPS=0
LUNAR_LANDER_CONTINUOUS=false

# ==============================================================================
# Toy Text Environments
# ==============================================================================
# FrozenLake
FROZEN_LAKE_IS_SLIPPERY=true
FROZEN_LAKE_MAP_NAME=4x4
# CliffWalking
CLIFF_WALKING_IS_SLIPPERY=false
# Taxi
TAXI_MAX_EPISODE_STEPS=0
# Blackjack
BLACKJACK_NATURAL=false
BLACKJACK_SAB=false

# ==============================================================================
# MuJoCo Environments
# ==============================================================================
MUJOCO_MAX_EPISODE_STEPS=0
MUJOCO_FRAME_SKIP=5
MUJOCO_RENDER_FPS=67
# Specific MuJoCo envs
ANT_MAX_EPISODE_STEPS=0
HALF_CHEETAH_MAX_EPISODE_STEPS=0
HOPPER_MAX_EPISODE_STEPS=0
HUMANOID_MAX_EPISODE_STEPS=0
WALKER2D_MAX_EPISODE_STEPS=0
SWIMMER_MAX_EPISODE_STEPS=0
REACHER_MAX_EPISODE_STEPS=0

# ==============================================================================
# Atari Environments
# ==============================================================================
ATARI_MAX_EPISODE_STEPS=0
ATARI_FRAMESKIP=4
ATARI_REPEAT_ACTION_PROBABILITY=0.0
ATARI_FULL_ACTION_SPACE=false
ATARI_RENDER_MODE=rgb_array

# ==============================================================================
# MiniGrid Environments
# ==============================================================================
MINIGRID_MAX_EPISODE_STEPS=0
MINIGRID_TILE_SIZE=32
MINIGRID_AGENT_VIEW_SIZE=7
MINIGRID_HIGHLIGHT=true
MINIGRID_AGENT_PNOV=false

# ==============================================================================
# ViZDoom Environments
# ==============================================================================
VIZDOOM_MAX_EPISODE_STEPS=0
VIZDOOM_FRAME_SKIP=4
VIZDOOM_RENDER_HUD=false
VIZDOOM_RENDER_CROSSHAIR=false
VIZDOOM_RENDER_WEAPON=true

# ==============================================================================
# MiniHack/NetHack Environments
# ==============================================================================
MINIHACK_MAX_EPISODE_STEPS=0
NETHACK_MAX_EPISODE_STEPS=0
NETHACK_OBSERVATION_KEYS=glyphs,blstats,message

# ==============================================================================
# Crafter Environment
# ==============================================================================
CRAFTER_MAX_EPISODE_STEPS=0
CRAFTER_AREA_SIZE=64x64
CRAFTER_VIEW_SIZE=9x9

# ==============================================================================
# Procgen Environments
# ==============================================================================
PROCGEN_NUM_LEVELS=0
PROCGEN_START_LEVEL=0
PROCGEN_PAINT_VEL_INFO=false
PROCGEN_USE_GENERATED_ASSETS=false
PROCGEN_CENTER_AGENT=true
PROCGEN_USE_SEQUENTIAL_LEVELS=false
PROCGEN_DISTRIBUTION_MODE=easy

# ==============================================================================
# Platform Settings
# ==============================================================================
PLATFORM=ubuntu

# ==============================================================================
# MuJoCo Settings
# ==============================================================================
# Options: egl, glfw, osmesa
MUJOCO_GL=egl

# ==============================================================================
# gRPC Configuration
# ==============================================================================
GRPC_VERBOSITY=debug

# ==============================================================================
# UI Settings
# ==============================================================================
# Start with Chat panel collapsed (true/false, default: true)
CHAT_PANEL_COLLAPSED=true

# ==============================================================================
# vLLM Server Configuration
# ==============================================================================
# Maximum number of vLLM server instances (1-8, default: 4)
# Each server runs on a separate port (8000, 8001, etc.)
VLLM_MAX_SERVERS=4

# GPU memory utilization per vLLM server (0.1-0.95, default: 0.85)
# This is the fraction of GPU memory each server will use
# 0.85 = 85% allocated to vLLM, leaving 15% for system and other tasks
# Lower values (0.7-0.8) if running multiple servers or other GPU workloads
# Higher values (0.9) only if vLLM is the sole GPU application
VLLM_GPU_MEMORY_UTILIZATION=0.85

# ==============================================================================
# LLM Chat Configuration (OpenRouter + vLLM)
# ==============================================================================
# OpenRouter (Cloud): Get API key from https://openrouter.ai/keys
# You can also enter the API key directly in the Chat panel UI.
OPENROUTER_API_KEY=sk-or-v1-your_api_key_here

# vLLM (Local): Start server with 'vllm serve <model> --api-key token-abc123'
# See: https://docs.vllm.ai/en/latest/serving/openai_compatible_server.html
# VLLM_BASE_URL=http://localhost:8000/v1
# VLLM_API_KEY=EMPTY

# HuggingFace Token (required for gated models like Llama)
# Get your token from: https://huggingface.co/settings/tokens
# Accept model license at: https://huggingface.co/meta-llama
# You can also enter the token directly in the Chat panel UI.
# HF_TOKEN=hf_your_token_here

# Proxy Configuration (for HuggingFace model downloads)
# Enable and configure proxy in the Chat panel UI, or set these environment variables.
# Useful when behind a firewall or in regions with restricted access.
# HTTP_PROXY=http://127.0.0.1:7890
# HTTPS_PROXY=https://127.0.0.1:7890

# ==============================================================================
# Weights & Biases (wandb) Configuration
# ==============================================================================
# Get your API key from: https://wandb.ai/authorize
WANDB_API_KEY=your_wandb_api_key_here

# Project and entity names
WANDB_PROJECT_NAME=MOSAIC
WANDB_ENTITY_NAME=your_wandb_username

# Your wandb account email
WANDB_EMAIL=your_email@example.com

# Optional: VPN proxy settings (uncomment if needed)
# WANDB_VPN_HTTPS_PROXY=https://127.0.0.1:7890
# WANDB_VPN_HTTP_PROXY=http://127.0.0.1:7890

# Monitor Gym environments with wandb (0=disabled, 1=enabled)
WANDB_MONITOR_GYM=0

# ==============================================================================
# SMAC / SMACv2 (StarCraft Multi-Agent Challenge) Environments
# ==============================================================================
# SMAC requires the StarCraft II Linux headless client.
# Download from: https://github.com/Blizzard/s2client-proto#linux-packages
#
# Quick setup:
#   1. wget https://blzdistsc2-a.akamaihd.net/Linux/SC2.4.10.zip
#   2. unzip SC2.4.10.zip -d var/data          (password: iagreetotheeula)
#   3. pip install git+https://github.com/oxwhirl/smac.git
#   4. Copy maps from repo to SC2:
#      git clone --depth 1 --sparse https://github.com/oxwhirl/smac.git /tmp/smac_repo
#      cd /tmp/smac_repo && git sparse-checkout set smac/env/starcraft2/maps/SMAC_Maps
#      cp -r smac/env/starcraft2/maps/SMAC_Maps var/data/StarCraftII/Maps/
#
# SC2PATH: Path to StarCraft II installation directory.
# Default: var/data/StarCraftII (project-local) if it exists, otherwise must be set.
# SC2PATH=~/StarCraftII

# Required: s2clientprotocol ships protobuf 3.x pb2 files; our gRPC/TF stack
# needs protobuf 5.x. Pure-Python protobuf implementation handles both.
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python

# AI difficulty level (1=VeryEasy, 7=default SMAC benchmark, 10=CheatInsane)
SMAC_DIFFICULTY=7

# Reward type: shaped (default) includes per-step damage/kill rewards;
# sparse gives only +1 for win, 0 otherwise
SMAC_REWARD_SPARSE=false

# Observation features (true/false)
SMAC_OBS_OWN_HEALTH=true
SMAC_OBS_PATHING_GRID=false
SMAC_OBS_TERRAIN_HEIGHT=false

# Episode step limit override (0 = use map default)
SMAC_EPISODE_LIMIT=0

# ==============================================================================
# XuanCe / mpi4py Configuration
# ==============================================================================
# Prevent mpi4py from calling MPI_Init() at import time.
# XuanCe imports mpi4py at module level (statistic_tools.py); OpenMPI's
# MPI_Init() blocks forever when not launched via mpirun/mpiexec.
# Set to 0 to skip auto-init (recommended for GUI and single-process usage).
# Set to 1 only when launching distributed training:
#   mpirun -np <N> xuance-worker --method mappo --env mpe ...
MPI4PY_RC_INITIALIZE=0

# Disable tqdm progress bars globally.
# XuanCe's training loops (on_policy_marl.py) use tqdm to write a progress
# bar to stderr on every iteration (250k+ writes per phase). When the training
# process's stderr is piped to the telemetry proxy, the 1MB kernel pipe buffer
# fills up and the OS blocks the training process on write -- a pipe deadlock.
# Set to 1 to suppress all tqdm output (training progress is tracked via
# TensorBoard and FastLane instead). Must be set before tqdm is first imported.
TQDM_DISABLE=1

# ==============================================================================
# TensorFlow/Keras Configuration (for Melting Pot)
# ==============================================================================
# Suppress TensorFlow logging (0=all, 1=info, 2=warning, 3=error)
TF_CPP_MIN_LOG_LEVEL=2

# Disable oneDNN custom operations messages
TF_ENABLE_ONEDNN_OPTS=0

# ==============================================================================